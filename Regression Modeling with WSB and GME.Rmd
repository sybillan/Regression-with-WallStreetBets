---
title: "GME Regression Model"
output: github_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=TRUE, message=FALSE,warning=FALSE}

#Using Statlearning to draw regression model of how the users of subreddit WallStreetBets drove price of GME in 2021

#Initial Setup

library(dplyr) # for filter and join 
library(readr) # for read_csv
library(tidyverse) #for str_which

#Loading WallStreetBets file
dataset1 <- read_csv("reddit_wsb.csv",col_types = cols(.default = "c"))
head(dataset1)

#Loading GME Market data from Jan to April 2021
GME<-read.table(unz("archive.zip","GME.csv"), header=T,quote="\"",sep=",")
head(GME)
```

WSB data for feature 'title' has punctuation in text including ",", ";", ".", "/", "", and also, notoriously, the csv delimiter "\|" in title text. We are using gsub for eliminating delimiters from the title. Thanks to [MLane\@Kaggle] for providing the Data Cleaning algorithm. 

```{r clean, include=TRUE, message=FALSE,warning=FALSE}
dataset1$title = gsub(pattern = "\\,",".",dataset1$title)
dataset1$body  = gsub(pattern = "\\,",".",dataset1$body)
wsb<-dataset1

```

Regression Fit Against frequency of daily posts that mention 'GME' or 'GameStop'

```{r,echo=TRUE}
#Formatting Dates on both GME and WSB file
GME$Date<-as.Date(GME$Date,"%Y-%m-%d")  
wsb$X<-as.Date(wsb$timestamp,"%m/%d/%Y")

#Filter for keywords 'GameStop' and 'GME' using index
m<-str_which(wsb$title,"GME")
m<-append(m,str_which(wsb$title,"GameStop"))
wsb_gamestop<-wsb[c(m),]

#Deriving the frequency table for GameStop/GME Mentions in subreddit against Date
freq<-data.frame(table(wsb_gamestop$X))
freq$Var1<-as.Date(freq$Var1,"%Y-%m-%d")
colnames(freq)<-c("Date","Freq")

#Performing Left Join with the GME Stock Index file via Date
GME<-dplyr::left_join(GME,freq,by="Date")

GME$Freq[is.na(GME$Freq)] <- 0

#Regression modeling of GME High Price against frequency of GME mentions on WallStreetBets 
summary(lm(High~Freq,data=GME))

plot(GME$Freq, GME$High)

abline(lm(High~Freq,data=GME))

```

The abline is the least squares line and is determined by the coefficient estimates  β0 ~ 143.5 (intercept) and β1~ 0.097 (slope). F statistic >1 and R squared value 0.1135 measures order of variance between Daily Volume of GME mentions on WallStreetBets and GME'S High price. Null hypothesis can be rejected, since p is significant at 0.00162. So, we reject the null hypothesis and deem there to be some causal relationship between predictor and dependent variable.

```{r}
wsb.lm<-lm(High~Freq, data=GME)
wsb.res<-resid(wsb.lm)
plot(GME$Freq, wsb.res, ylab="Residuals",xlab="Freq",main="Residual plot")

```


Multiple Regression Fit Against Musk's tweet that mentions GME/GameStop 'Gamestonk'

```{r}
#Assessing Impact of Musk's solitary tweet on 26th Jan on GME Price Movement
GME$Musk<-0
GME$Musk[GME$Date=="2021-01-26"]<-1

summary(lm(High~Freq+Musk,data=GME))
```

There is no relationship to be inferred between GME's High Price with Musk's tweet. As observed, p=0.94173 is not significant and Residual Standard Error is high at 89.57.

```{r,echo=TRUE}
GME$Change<-((GME$Close-GME$Open)/GME$Open)*100
summary(lm(Change~Freq+Musk,data=GME))

plot(GME$Musk,GME$Change)
abline(lm(Change~Musk,data=GME))

```

Multiple Regression Fit Against Musk's tweet that mentions GME/GameStop 'Gamestonk'

```{r,echo=TRUE}
GME$Musk<-0
GME$Musk[GME$Date=="2021-01-26"]<-1

summary(lm(High~Freq+Musk,data=GME))
GME$Change<-((GME$Close-GME$Open)/GME$Open)*100

summary(lm(Change~Freq+Musk,data=GME))

plot(GME$Musk,GME$Change)
abline(lm(Change~Musk,data=GME))
```

While GME's High Price is not responsive to Musk's tweeting, the % change in price is, with p-value at 0.000882 and also observable using correlation function. % Change in Stock Price is positively correlated with Musk's tweeting with F-Statistic being 6.948 and >1. 

```{r,echo=TRUE}
correlation_matrix<-cor(GME[,-1])
correlation_matrix
```
